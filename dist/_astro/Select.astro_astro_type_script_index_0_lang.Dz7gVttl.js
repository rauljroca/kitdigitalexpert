import{d as T}from"./debounce.DT8DhbJn.js";import{o as E}from"./DOMUtils.DAQrewGk.js";import{d as y,l as D}from"./event.C5jlCmtE.js";const P=d=>{const{trigger:i,modal:a,onOpen:m,onClose:s}=typeof d=="string"?{}:d,n=typeof d=="string"?d:a,r=document.querySelector(i),o=document.querySelector(n);if(o){const l=o.dataset.close?.split(","),e={icon(){const c=o.querySelector('[data-id="close"]'),p=()=>{o.dataset.show="",s?.({trigger:r,modal:o})};return{add:()=>c?.addEventListener("click",p),remove:()=>c?.removeEventListener("click",p)}},esc(){const c=p=>{o.dataset.show&&p.key==="Escape"&&(o.dataset.show="",s?.({trigger:r,modal:o}))};return{add:()=>document.addEventListener("keydown",c),remove:()=>document.removeEventListener("keydown",c)}},overlay(){const c=o.nextElementSibling,p=()=>{o.dataset.show="",s?.({trigger:r,modal:o})};return{add:()=>c?.addEventListener("click",p),remove:()=>c?.removeEventListener("click",p)}}},h=()=>{o.dataset.show="true",m?.({trigger:r,modal:o})};return r?.addEventListener("click",h),l?.forEach(c=>{e[c]().add()}),{open(){h()},remove(){r?.removeEventListener("click",h),l?.forEach(c=>{e[c]().remove()})}}}},Y=d=>{const i=document.querySelector(d);i&&(i.dataset.show="")},x=({trigger:d,popover:i,position:a,offset:m=10,closeOnBlur:s=!0,closeOnEsc:n=!0,onOpen:r,onClose:o})=>{const l=document.querySelector(d),e=document.querySelector(i);if(l&&e){document.body.appendChild(e),a&&(e.dataset.position=a.split("-")[0]);const h=()=>{const t=l.getBoundingClientRect(),u=e.getBoundingClientRect(),v=t.top+window.scrollY-u.height-m,w=t.top+window.scrollY+t.height+m,f=t.left-u.width-m,g=t.left+t.width+m,S=t.left-(u.width-t.width)/2,O=t.left-(u.width-t.width),L=t.top+window.scrollY-(u.height-t.height)/2,C=t.top+window.scrollY,q=t.top+window.scrollY-(u.height-t.height),$={"top-start":{top:v,left:t.left},top:{top:v,left:S},"top-end":{top:v,left:O},"left-start":{top:C,left:f},left:{top:L,left:f},"left-end":{top:q,left:f},"right-start":{top:C,left:g},right:{top:L,left:g},"right-end":{top:q,left:g},"bottom-start":{top:w,left:t.left},bottom:{top:w,left:S},"bottom-end":{top:w,left:O}},{top:M,left:R}=$[a]||$.bottom;e.style.top=`${M}px`,e.style.left=`${R}px`,setTimeout(()=>{e.dataset.show=e.dataset.show==="true"?"":"true"},0),setTimeout(()=>{e.dataset.show||e.removeAttribute("data-show")},300),r?.({trigger:l,popover:e,position:a})},c=t=>{const u=t.target;!e.contains(u)&&!l.contains(u)&&e.dataset.show&&(e.dataset.show="",o?.({trigger:l,popover:e,position:a})),setTimeout(()=>{e.dataset.show||e.removeAttribute("data-show")},300)},p=t=>{t.key==="Escape"&&e.dataset.show&&(e.dataset.show="",o?.({trigger:l,popover:e,position:a}),setTimeout(()=>{e.removeAttribute("data-show")},300))},A=T(()=>{e.dataset.show="",setTimeout(()=>{e.dataset.show||e.removeAttribute("data-show")},300)}),k=new ResizeObserver(()=>{e.dataset.show&&A()});return l.addEventListener("click",h),k.observe(document.body),s&&document.addEventListener("click",c),n&&document.addEventListener("keydown",p),{remove(){l.removeEventListener("click",h),k.disconnect(),s&&document.removeEventListener("click",c),n&&document.removeEventListener("keydown",p)}}}},z=Y,B=document.querySelectorAll('[data-id^="w-select"]');let b=!1;E(document,"keydown",d=>{d.key==="Tab"&&(b=!0)});E(document,"mousedown",()=>b=!1);Array.from(B).forEach(d=>{const i=d,a=i.dataset.id.split("w-select-")[1],m=i.dataset.position;if(m==="modal")P({trigger:`[data-id="${i.dataset.id}"]`,modal:`[data-id="w-options-${a}"]`,onOpen:({modal:s})=>{const n=s.querySelector("input");n&&n.focus()},onClose(s){y("selectOnClose",s)}});else{const s=T(()=>{const{width:n}=i.getBoundingClientRect(),r=document.querySelector(`[data-id="w-options-${a}"]`);r&&(r.style.width=`${n}px`)});new ResizeObserver(()=>s()).observe(document.body),x({trigger:`[data-id="${i.dataset.id}"]`,popover:`[data-id="w-options-${a}"]`,position:m||"bottom",onOpen({popover:n}){const r=n.querySelector("input");r?r.focus():n.focus()},onClose(n){y("selectOnClose",n)}})}E(i,"focus",s=>{b&&s.currentTarget.click()})});D("listOnSelect",d=>{const{name:i,list:a}=d,s=a.closest("dialog").dataset.id,n=s.split("w-options-")[1],r=`[data-id="w-select-${n}"]`,o=document.querySelector(r);z(`[data-id="${s}"]`),o.dataset.noUpdate||(o.value=i),y("selectOnChange",{...d,select:n})});
